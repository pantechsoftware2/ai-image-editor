# Quick Fix: Google Cloud Authentication for Vertex AI

Your `.env.local` has the correct `GOOGLE_CLOUD_PROJECT_ID=ai-image-editor-483505`, but you need to authenticate with Google Cloud.

## Solution: Setup Authentication (2 Options)

### Option A: Using Application Default Credentials (Recommended - 5 minutes)

#### Step 1: Install Google Cloud CLI

**Windows (PowerShell as Administrator):**
```powershell
# Download the installer
(New-Object System.Net.WebClient).DownloadFile('https://dl.google.com/dl/cloudsdk/channels/rapid/GoogleCloudSDKInstaller.exe', 'GoogleCloudSDKInstaller.exe')

# Run installer
.\GoogleCloudSDKInstaller.exe

# After installation, restart PowerShell and test:
gcloud --version
```

**Or use Chocolatey (if installed):**
```powershell
choco install google-cloud-sdk -y
```

#### Step 2: Authenticate with Google Account

```powershell
# Login to Google Cloud
gcloud auth application-default login

# This opens a browser - sign in with your Google account
# Accept permissions when asked
# Credentials saved to: C:\Users\[YourUsername]\AppData\Roaming\gcloud\application_default_credentials.json
```

#### Step 3: Verify Authentication

```powershell
# Check if credentials are working
gcloud auth application-default print-access-token

# Should show a long token string (if working)
```

#### Step 4: Restart Dev Server

```powershell
cd "c:\Users\pante\Downloads\ai-image-editor"
npm run dev
```

---

### Option B: Using Service Account Key (For Production)

If you already have a service account key JSON file:

```powershell
# Set environment variable to point to your key
$env:GOOGLE_APPLICATION_CREDENTIALS = "C:\path\to\service-account-key.json"

# Add to .env.local for persistence:
# GOOGLE_APPLICATION_CREDENTIALS=C:\path\to\service-account-key.json

# Then restart dev server
npm run dev
```

---

## Verify It Works

1. Start dev server: `npm run dev`
2. Go to http://localhost:3000
3. Login
4. Go to Editor page
5. Enter "google.com" ‚Üí Extract Brand
6. Type "coffee" ‚Üí Generate Image
7. Check browser console (F12) for logs:
   - ‚úÖ Should see: "üîê Initializing Vertex AI..."
   - ‚úÖ Should see: "‚ú® Generated 4 images"
   - ‚ùå If you see: "Unable to authenticate" ‚Üí Go back to Step 2 above

---

## Quick Checklist

- [ ] Downloaded Google Cloud SDK installer
- [ ] Ran installer and restarted PowerShell
- [ ] Verified `gcloud --version` works
- [ ] Ran `gcloud auth application-default login`
- [ ] Saw credentials saved message
- [ ] Tested `gcloud auth application-default print-access-token` shows a token
- [ ] Restarted `npm run dev`
- [ ] Tested image generation (type "coffee" in editor)

---

## Troubleshooting

### "gcloud: The term is not recognized"
‚Üí Google Cloud SDK not installed. Use the installer above.

### "Unable to authenticate" in browser
‚Üí The credentials weren't saved. Run `gcloud auth application-default login` again.

### "GOOGLE_CLOUD_PROJECT_ID is not set"
‚Üí Your `.env.local` has it. But make sure `npm run dev` restarted AFTER you added it.

### "Quota exceeded"
‚Üí You've hit the free tier limit. Check Google Cloud Console for usage.

---

## Your Current Setup

‚úÖ `.env.local` has all Supabase credentials
‚úÖ `.env.local` has GOOGLE_CLOUD_PROJECT_ID=ai-image-editor-483505
‚ùå Missing: Google Cloud authentication (gcloud login)

**Next Step:** Follow Option A above (5 minutes to fix)

---

**After you complete the authentication setup, come back and tell me if it works!**
